<!-- åœ°å€ç®¡ç†é¡µé¢ -->
<view class="page-container">
  <!-- åœ°å€åˆ—è¡¨ -->
  <view class="address-list" wx:if="{{addressList.length > 0}}">
    <block wx:for="{{addressList}}" wx:key="address_id">
      <view class="address-item {{item.is_default ? 'default' : ''}}">
        <view class="address-content" bindtap="selectAddress" data-address="{{item}}">
          <view class="address-header">
            <text class="receiver-name">{{item.receiver_name}}</text>
            <text class="receiver-phone">{{item.receiver_phone}}</text>
            <view class="default-tag" wx:if="{{item.is_default}}">é»˜è®¤</view>
          </view>
          <view class="address-detail">
            {{item.province}} {{item.city}} {{item.district}} {{item.detail_address}}
          </view>
        </view>
        <view class="address-actions">
          <button class="action-btn edit-btn" bindtap="editAddress" data-address="{{item}}" size="mini">ç¼–è¾‘</button>
          <button class="action-btn delete-btn" bindtap="deleteAddress" data-id="{{item.address_id}}" size="mini">åˆ é™¤</button>
        </view>
      </view>
    </block>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <view class="empty-icon">ğŸ“</view>
    <view class="empty-text">æš‚æ— æ”¶è´§åœ°å€</view>
    <view class="empty-desc">æ·»åŠ æ”¶è´§åœ°å€ï¼Œäº«å—ä¾¿æ·è´­ç‰©ä½“éªŒ</view>
  </view>

  <!-- æ–°å¢åœ°å€æŒ‰é’® -->
  <view class="add-address-btn" bindtap="showAddForm">
    <text class="add-icon">+</text>
    <text class="add-text">æ–°å¢æ”¶è´§åœ°å€</text>
  </view>
</view>

<!-- æ–°å¢/ç¼–è¾‘åœ°å€å¼¹çª— -->
<view class="address-modal" wx:if="{{showAddressForm}}">
  <view class="modal-mask" bindtap="hideAddForm"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">{{editingAddress ? 'ç¼–è¾‘åœ°å€' : 'æ–°å¢åœ°å€'}}</text>
      <view class="modal-close" bindtap="hideAddForm">Ã—</view>
    </view>
    <view class="form-content">
      <view class="form-item">
        <text class="form-label">æ”¶è´§äºº</text>
        <input class="form-input" placeholder="è¯·è¾“å…¥æ”¶è´§äººå§“å" value="{{formData.receiver_name}}" bindinput="onInputChange" data-field="receiver_name" />
      </view>
      <view class="form-item">
        <text class="form-label">æ‰‹æœºå·</text>
        <input class="form-input" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" value="{{formData.receiver_phone}}" bindinput="onInputChange" data-field="receiver_phone" type="number" />
      </view>
      <view class="form-item">
        <text class="form-label">æ‰€åœ¨åœ°åŒº</text>
        <picker mode="multiSelector" range="{{regionData}}" range-key="name" value="{{regionIndex}}" bindchange="onRegionChange">
          <view class="picker-text {{!formData.province ? 'placeholder' : ''}}">
            {{formData.province && formData.city && formData.district ? formData.province + ' ' + formData.city + ' ' + formData.district : 'è¯·é€‰æ‹©çœå¸‚åŒº'}}
          </view>
        </picker>
      </view>
      <view class="form-item">
        <text class="form-label">è¯¦ç»†åœ°å€</text>
        <textarea class="form-textarea" placeholder="è¯·è¾“å…¥è¯¦ç»†åœ°å€" value="{{formData.detail_address}}" bindinput="onInputChange" data-field="detail_address" maxlength="100"></textarea>
      </view>
      <view class="form-item checkbox-item">
        <checkbox checked="{{formData.is_default}}" bindtap="toggleDefault" />
        <text class="checkbox-label">è®¾ä¸ºé»˜è®¤åœ°å€</text>
      </view>
    </view>
    <view class="form-actions">
      <button class="cancel-btn" bindtap="hideAddForm">å–æ¶ˆ</button>
      <button class="confirm-btn" bindtap="saveAddress" loading="{{saving}}">{{saving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜'}}</button>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-mask" wx:if="{{loading}}">
  <view class="loading-content">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>