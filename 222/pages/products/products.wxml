<!-- äº§å“é¡µé¢ -->
<view class="page-container">
  <!-- äº§å“æ ‡é¢˜ -->
  <view class="products-header">
    <view class="container">
      <view class="section-header">
        <view class="section-title">æˆ‘ä»¬çš„äº§å“</view>
        <view class="section-description">æµè§ˆæˆ‘ä»¬ç²¾é€‰çš„é«˜å“è´¨ç©å¶ï¼Œä¸ºæ‚¨çš„å®¶å±…ç”Ÿæ´»å¢æ·»èˆ’é€‚ä¸ç¾æ„Ÿ</view>
      </view>
    </view>
  </view>

  <!-- ç­›é€‰å™¨ -->
  <view class="filter-section">
    <view class="container">
      <view class="filter-row">
        <view class="filter-group">
          <view class="filter-label">æ’åºæ–¹å¼:</view>
          <picker bindchange="changeSorting" value="{{sortingIndex}}" range="{{sortingOptions}}">
            <view class="filter-value">
              {{sortingOptions[sortingIndex]}} â–¼
            </view>
          </picker>
        </view>
        
        <view class="filter-group">
          <view class="filter-label">ä»·æ ¼åŒºé—´:</view>
          <picker bindchange="changePriceRange" value="{{priceRangeIndex}}" range="{{priceRangeOptions}}">
            <view class="filter-value">
              {{priceRangeOptions[priceRangeIndex]}} â–¼
            </view>
          </picker>
        </view>
        

      </view>
      
      <view class="filter-tags">
        <block wx:for="{{activeTags}}" wx:key="id">
          <view class="filter-tag" bindtap="removeTag" data-id="{{item.id}}">
            {{item.name}} Ã—
          </view>
        </block>
      </view>
    </view>
  </view>

  <!-- äº§å“åˆ—è¡¨ -->
  <view class="products-list">
    <view class="container">
      <!-- åŠ è½½çŠ¶æ€ -->
      <view wx:if="{{loading && products.length === 0}}" class="loading-container">
        <view class="loading-spinner"></view>
        <text class="loading-text">åŠ è½½ä¸­...</text>
      </view>
      
      <!-- ç©ºçŠ¶æ€ -->
      <view wx:elif="{{!loading && products.length === 0}}" class="empty-container">
        <view class="empty-icon">ğŸ“¦</view>
        <text class="empty-text">æš‚æ— å•†å“</text>
        <text class="empty-desc">è¯·å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶</text>
      </view>
      
      <!-- äº§å“ç½‘æ ¼ -->
      <view wx:else class="products-grid">
        <block wx:for="{{products}}" wx:key="id">
          <view class="product-card" bindtap="navigateToProduct" data-id="{{item.id}}">
            <view class="product-image-container">
              <image src="{{item.image}}" class="product-image" mode="aspectFill" lazy-load="true" />
              <view class="product-add-to-cart" catchtap="addToCart" data-id="{{item.id}}">åŠ å…¥è´­ç‰©è½¦</view>
            </view>
            <view class="product-content">
              <view class="product-rating">
                <view class="rating-stars">
                  <block wx:for="{{5}}" wx:key="*this" wx:for-item="star">
                    <text>{{star < item.rating ? 'â˜…' : (star === Math.floor(item.rating) && item.rating % 1 !== 0 ? 'â˜†' : 'â˜†')}}</text>
                  </block>
                </view>
                <text class="rating-count">({{item.ratingCount}})</text>
              </view>
              <view class="product-title">{{item.title}}</view>
              <view class="product-description">{{item.description}}</view>
              <view class="product-footer">
                <text class="product-price">Â¥{{item.price}}</text>
                <view class="add-to-cart-button" catchtap="addToCart" data-id="{{item.id}}">
                  ğŸ›’
                </view>
              </view>
            </view>
          </view>
        </block>
      </view>
      
      <!-- åŠ è½½æ›´å¤š -->
      <view wx:if="{{loading && products.length > 0}}" class="load-more">
        <view class="loading-spinner"></view>
        <text class="loading-text">åŠ è½½ä¸­...</text>
      </view>
      
      <!-- åˆ†é¡µ -->
      <view wx:if="{{products.length > 0}}" class="pagination">
        <view class="page-button {{currentPage === 1 || loading ? 'disabled' : ''}}" bindtap="prevPage">
          â† ä¸Šä¸€é¡µ
        </view>
        <view class="page-info">{{currentPage}}/{{totalPages}}</view>
        <view class="page-button {{!hasMore || loading ? 'disabled' : ''}}" bindtap="nextPage">
          ä¸‹ä¸€é¡µ â†’
        </view>
      </view>
    </view>
  </view>
</view>